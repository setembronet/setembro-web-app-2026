{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sergio/Documents/antigravity/setembro.net/site_setembro/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function createClient() {\r\n    const cookieStore = await cookies();\r\n\r\n    return createServerClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return cookieStore.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    try {\r\n                        cookiesToSet.forEach(({ name, value, options }) =>\r\n                            cookieStore.set(name, value, options)\r\n                        );\r\n                    } catch {\r\n                        // The `setAll` method was called from a Server Component.\r\n                        // This can be ignored if you have middleware refreshing\r\n                        // user sessions.\r\n                    }\r\n                },\r\n            },\r\n        }\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,0IAAO;IAEjC,OAAO,IAAA,+LAAkB,oKAGrB;QACI,SAAS;YACL;gBACI,OAAO,YAAY,MAAM;YAC7B;YACA,QAAO,YAAY;gBACf,IAAI;oBACA,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC1C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAErC,EAAE,OAAM;gBACJ,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACrB;YACJ;QACJ;IACJ;AAER"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sergio/Documents/antigravity/setembro.net/site_setembro/src/lib/ai/gemini.ts"],"sourcesContent":["// src/lib/ai/gemini.ts\r\n\r\nexport async function generateEmbedding(text: string): Promise<number[] | null> {\r\n    if (!text || text.trim() === '') return null;\r\n\r\n    // Note: In Next.js Server Actions, process.env is securely available.\r\n    const apiKey = process.env.GEMINI_API_KEY;\r\n    if (!apiKey) {\r\n        console.warn(\"GEMINI_API_KEY is not set. Embedding generation will fail.\");\r\n        return null;\r\n    }\r\n\r\n    try {\r\n        const response = await fetch(\r\n            `https://generativelanguage.googleapis.com/v1beta/models/text-embedding-004:embedContent?key=${apiKey}`,\r\n            {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    model: \"models/text-embedding-004\",\r\n                    content: { parts: [{ text }] }\r\n                })\r\n            }\r\n        );\r\n\r\n        if (!response.ok) {\r\n            console.error(\"Gemini API falhou com status:\", response.status);\r\n            return null;\r\n        }\r\n\r\n        const data = await response.json();\r\n\r\n        if (data.embedding && data.embedding.values) {\r\n            return data.embedding.values;\r\n        }\r\n\r\n        return null;\r\n    } catch (error) {\r\n        console.error(\"Failed to generate embedding with Gemini:\", error);\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;AAEhB,eAAe,kBAAkB,IAAY;IAChD,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI,OAAO;IAExC,sEAAsE;IACtE,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;IACzC,IAAI,CAAC,QAAQ;QACT,QAAQ,IAAI,CAAC;QACb,OAAO;IACX;IAEA,IAAI;QACA,MAAM,WAAW,MAAM,MACnB,CAAC,4FAA4F,EAAE,QAAQ,EACvG;YACI,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACjB,OAAO;gBACP,SAAS;oBAAE,OAAO;wBAAC;4BAAE;wBAAK;qBAAE;gBAAC;YACjC;QACJ;QAGJ,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,QAAQ,KAAK,CAAC,iCAAiC,SAAS,MAAM;YAC9D,OAAO;QACX;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,KAAK,SAAS,IAAI,KAAK,SAAS,CAAC,MAAM,EAAE;YACzC,OAAO,KAAK,SAAS,CAAC,MAAM;QAChC;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6CAA6C;QAC3D,OAAO;IACX;AACJ"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sergio/Documents/antigravity/setembro.net/site_setembro/src/actions/search-posts.ts"],"sourcesContent":["'use server';\r\n\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { generateEmbedding } from '@/lib/ai/gemini';\r\n\r\nexport type SearchResult = {\r\n    id: string;\r\n    title: string;\r\n    slug: string;\r\n    excerpt: string;\r\n    featured_image: string;\r\n    published_at: string;\r\n    category_id: string;\r\n    semantic_similarity: number;\r\n    keyword_score: number;\r\n};\r\n\r\nexport async function searchPosts(query: string, limit: number = 5): Promise<SearchResult[]> {\r\n    if (!query || query.trim().length === 0) return [];\r\n\r\n    const supabase = await createClient();\r\n\r\n    // 1. Generate an embedding for the user's search query using Gemini (Julia)\r\n    const queryEmbedding = await generateEmbedding(query);\r\n\r\n    // Fallback: If AI fails or doesn't return vector, use zero-vector to run keyword-only search\r\n    const vectorStr = queryEmbedding\r\n        ? `[${queryEmbedding.join(',')}]`\r\n        : `[${new Array(768).fill(0).join(',')}]`;\r\n\r\n    // 2. Call the hybrid search RPC function we created in Supabase\r\n    const { data, error } = await supabase.rpc('search_posts_hybrid', {\r\n        query_embedding: vectorStr,\r\n        query_text: query,\r\n        match_count: limit\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Hybrid Search Error:\", error.message);\r\n        return [];\r\n    }\r\n\r\n    return (data as SearchResult[]) || [];\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAcO,eAAe,YAAY,KAAa,EAAE,QAAgB,CAAC;IAC9D,IAAI,CAAC,SAAS,MAAM,IAAI,GAAG,MAAM,KAAK,GAAG,OAAO,EAAE;IAElD,MAAM,WAAW,MAAM,IAAA,gJAAY;IAEnC,4EAA4E;IAC5E,MAAM,iBAAiB,MAAM,IAAA,+IAAiB,EAAC;IAE/C,6FAA6F;IAC7F,MAAM,YAAY,iBACZ,CAAC,CAAC,EAAE,eAAe,IAAI,CAAC,KAAK,CAAC,CAAC,GAC/B,CAAC,CAAC,EAAE,IAAI,MAAM,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;IAE7C,gEAAgE;IAChE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,GAAG,CAAC,uBAAuB;QAC9D,iBAAiB;QACjB,YAAY;QACZ,aAAa;IACjB;IAEA,IAAI,OAAO;QACP,QAAQ,KAAK,CAAC,wBAAwB,MAAM,OAAO;QACnD,OAAO,EAAE;IACb;IAEA,OAAO,AAAC,QAA2B,EAAE;AACzC;;;IA1BsB;;AAAA,+OAAA"}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sergio/Documents/antigravity/setembro.net/site_setembro/.next-internal/server/app/admin/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {searchPosts as '6001eda03d383734b42166c9fafa36b61d552e9557'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}